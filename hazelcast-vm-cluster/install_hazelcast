#! /bin/bash
MIN_HEAP_SIZE=$1
MAX_HEAP_SIZE=$2
sudo apt-get update -y
sudo apt-get install openjdk-8-jre -y
sudo apt-get install maven -y

#### minimum heap size
if [ "x$MIN_HEAP_SIZE" = "x" ]
 then
   MIN_HEAP_SIZE=4G
fi
if [ "x$MAX_HEAP_SIZE" = "x" ]
 then
  MAX_HEAP_SIZE=4G
fi

if [ "x$MIN_HEAP_SIZE" != "x" ]; then
  JAVA_OPTS="$JAVA_OPTS -Xms${MIN_HEAP_SIZE}"
fi
if [ "x$MAX_HEAP_SIZE" != "x" ]; then
  JAVA_OPTS="$JAVA_OPTS -Xms${MAX_HEAP_SIZE}"
fi
# persist this variable to the VM environment
sudo echo "JAVA_OPTIONS=$JAVA_OPTS" >> /etc/environment

# create the hazelcast home directory
sudo mkdir /var/hazelcast
sudo cp pom.xml /var/hazelcast
sudo mvn install
sudo cp ./hazelcast.xml /var/hazelcast/
